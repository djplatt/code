/* code for RMT distributions relating to L_chi(1/2) */

\p40
one_2_pi=1/2/Pi;

dist1(y,NN,a,b)=one_2_pi*intnum(s=a,b,real(prod(j=1,NN,(j-1)!*gamma(j+I*s)/gamma(j+(I*s)/2)^2)*exp(-I*y*s)))

/* dist equates to Re log(L(1/2,\chi)) */
dist(y,NN,a)=dist1(y,NN,-a,a)

/* dist2 equates to |L(1/2,\chi)|=dist1(log(y),NN,a)/y */
dist2(y,NN,a,b)=one_2_pi/y*intnum(s=a,b,real(prod(j=1,NN,(j-1)!*gamma(j+I*s)/gamma(j+(I*s)/2)^2)*exp(-I*log(y)*s)))

arith(x)={
   local r;

   r=5.87949564480708634682428571524106638958614805703 E-78*x^127 - 1.373334682849256355803400806192375735312278483886 E-76*x^126 +3.13553813619324417094082108085443476998950859315 E-76*x^125 + 3.75073624620678387522673378433832871343007153538 E-75*x^124 - 2.01841541120841400655842698118595302874873935618 E-74*x^123 -  8.38363285705083164832638758787447377252342025009 E-74*x^122 + 9.02002255545521500051362725337151904510118012633 E-73*x^121 + 7.61399990433695017445096740166794390111555199254 E-73*x^120 - 3.278881960103150731804533137770606347647537278539212315587 E-71*x^119 + 5.25230022456502874249003710793665309050566600009 E-71*x^118 + 9.884223622650813822211021188427903804952578477851129133092 E-70*x^117 - 4.149890018843399596356632513938918632461659545494178383407 E-69*x^116 - 2.339545792429025771165159569264891647393877607711380445141 E-68*x^115 + 1.943839074742771651976211286052656381659811217231041328062 E-67*x^114 + 3.224297643000158994688396613348952428364431469784853543305 E-67*x^113 - 7.147094720645447710435735545475867663796738602345610204862 E-66*x^112 + 5.91420251071348034528886451226399846342964945672 E-66*x^111 + 2.165512543434239272943426658579894028150929100759934372547 E-64*x^110 - 6.830295792611691077817178113417005009907714217708439508588 E-64*x^109 - 5.253182067222063064544370269539676822496246890409397237791 E-63*x^108 + 3.345759369273202544685073182705156614872658884468193963735 E-62*x^107 + 8.50788734160395187708549417634085389333299854721071066031 E-62*x^106 - 1.2313251373450059875261958600823196009658931312864595046632 E-60*x^105 + 2.686972250842278959190225678023284768957888170261641458887 E-61*x^104 + 3.703975538987358225551716104755549909314630421277820759436 E-59*x^103 - 9.37662247732110043576497673661322611953179107538253541792 E-59*x^102 - 9.034446095236543014492696245481291593824803977180576275588265838855 E-58*x^101 + 4.8355125888334355608932253734542616529131575953448756676503558572478 E-57*x^100 + 1.5866903313464276765256451938178560735120939535649545768682317489016 E-56*x^99 - 1.7586474439947017080678720409786216973280068897329105254092554528128 E-55*x^98 - 6.627608090005123510659441353860758808435660640677336981673073144046 E-56*x^97 + 5.1367522399364048216950301422061638837929983530706470086334144353440 E-54*x^96 - 9.664897670621801079102445130823108729649031245058160128336066892016 E-54*x^95 - 1.2134211569696664243331627780901687838464547593615666864704832472152 E-52*x^94 + 5.449065929623895927813903192383845132352917973842356307992638829681 E-52*x^93 + 2.1074609554445121762595689556217664273744890887543624344223034721960 E-51*x^92 - 1.9780338400200822744871861114439647130665894377702482240705295577012 E-50*x^91 - 1.3117710336878347648496700002146281803821504692690640103208353294786 E-50*x^90 + 5.646972868504763285804893371566034127241254572829594634257880859915 E-49*x^89 - 8.813828851266404053343448189593092357138516325889622174778988590328 E-49*x^88 - 1.2984187561433430824944426159358414663977345272699106885150164189684 E-47*x^87 + 5.071695553604361198370280493917702549652153030589342433158610997552 E-47*x^86 + 2.2287297128656320373523352412525547346811034535248406635300711232177 E-46*x^85 - 1.7621579270538617009441509850041039893555732019993940457942904903377 E-45*x^84 - 1.7032862168202605539499708827047504615509127670840025380093024773942396040409 E-45*x^83 + 4.7497180402890958526209375193506480248321131270735220333256353608187308154353 E-44*x^82 - 6.3895333558341185764151627561398907370237100602166543256194145466388873223852 E-44*x^81 - 1.02695509138428861837801152082771417754332490215399548072889445498825508949694 E-42*x^80 + 3.8292349555244169573052592651537684287473564558577430769577285169884239948232 E-42*x^79 + 1.66279718436937525541330543841866328992562240438214609942269288903315152616524 E-41*x^78 - 1.27133831416304958330020428330438498118619949803670259922267972651061460888966 E-40*x^77 - 1.26109834733014864888364541859506274690982933717342280190472540662040561052740 E-40*x^76 + 3.2034274884363513665389882667874812952425918617259307782004300056855694960755 E-39*x^75 - 3.7698477949954149161091416006039244446692530273144004153511580797405014248255 E-39*x^74 - 6.3733273115913395214515101312668995893422714925592737125679581472720782218522 E-38*x^73 + 2.1842647625882416212129840946842663683718925497290812616166152791249046524706 E-37*x^72 + 9.2676501376158673764162602374556479951617258144203814458228391412952561495806 E-37*x^71 - 6.7841159662731992790089700058033237414414062552096723202147608562880275798664 E-36*x^70 - 5.4484488367648956923321918752828964515469634115206063838460686640510803265629 E-36*x^69 + 1.58691369379484381393759492813667584723898487230306230695448776290432329174326 E-34*x^68 - 2.16064314097578094516085665435815612630832859927842546392471622743508461503666943966116 E-34*x^67 - 2.9113923042849747141085508859822552302104236017425562571910917127799597104460 E-33*x^66 + 1.03081908836544007448874010287035529098944851590491179189806347781819393720428928690549 E-32*x^65 + 3.84961520264327023122636793991984326742051843821012271128437624632156167225941210379115381727864 E-32*x^64 - 2.804084452305835332791869845954545171138334785728808615631288132732666271536348115884431294226498 E-31*x^63 - 1.832023481847248528160945462811795902817997935433396147627093943658188046613456438732615850584498 E-31*x^62 + 5.75221567172032890963005410065063627529244471066544403421066388560454156072426018294661467344771 E-30*x^61 - 8.55562027676225775741612738968757079199272453526587140124803087121343718575920529155143349748229 E-30*x^60 - 9.12887239616608623393824671603344237153835160174147221577211047593539294694066912735057480518960 E-29*x^59 + 3.541802136778448534726908761236318989667260704765328926196295860075512656332209318872880872949074 E-28*x^58 + 9.93067659928641725174054793990931378882750870546132043999404465981799428638582160034029844891424 E-28*x^57 - 8.56231109738466728146582397385454731110349807988270893634059894227584310068908083463143986305786 E-27*x^56 - 1.525196441428235205022881199390671719169366613544199269795322486403508261493823734575156041097034 E-27*x^55 + 1.543097164102402007556260736815629336551779704523916677638947182342716011567191669969759481601247 E-25*x^54 - 2.638910388210035999836034291070151398610794721635612122579430058715154757367291828583874336548792 E-25*x^53 - 2.080782015348274178301861750605437413739276317927207295947628527821723385402520298040722389859592 E-24*x^52 + 8.40619821204401167573858528334271052948348429149949804394079601304388085324555658910079117887939 E-24*x^51 + 1.702584869495937030506761744963712383428653397575662755655089725472835185330917111243495436048329 E-23*x^50 - 1.718442518140920576451714449201804187289780851946061969057656744033566326374594636791435543938069 E-22*x^49 + 7.24675607620262611470721790807257598428111576453534812041313717098099231618814377103784027680397 E-23*x^48 + 2.647726790601422508622015505941704099218003836178576897105309799266830059386337962297248283755872 E-21*x^47 - 6.19190359672216470842567408741232094055499566959378729635793460774775477463086255003160043629947 E-21*x^46 - 2.99065821950636240651930566317268357327332124078100439590042762497214150591193789615638214539387 E-20*x^45 + 1.455076798291669288179168641268396310616642500494134004865124982311279019923432050649003718883459 E-19*x^44 + 1.767122403229452149524195227606361612622952946753616392227991981768001467021560881911378923409273 E-19*x^43 - 2.343670975797782409051734886539585082359358408353187949084513873813975362138670263127555632173010565 E-18*x^42 + 1.933764880489784555092650560763202972131923919935166303244324032637926601618837320315901197413953724 E-18*x^41 + 2.801146679527041371817835278640645212342625364318663911551431243520372567287428716689691078814176558 E-17*x^40 - 8.154551715964471600184539859249447630530157704316203139453714983630995989794815989062664447916904583 E-17*x^39 - 2.243702088242244465427779136450736612484511592660215218652721371713684356763132043154267965342028827 E-16*x^38 + 1.525262408666233554292352624320135825369438616622028778628734539442007152110244105355145709939002043 E-15*x^37 + 3.117457651565222149140141256092879895862024463286868696447545458906560808286948993076826234788532013 E-16*x^36 - 1.984036865075386191347471164601177093854261926838078172245146212762608912338855742054859809564829812 E-14*x^35 + 2.773964458911883834352005242649097219626904014437298820636200192682099651483489838326425642885864097 E-14*x^34 + 1.817139027284540779305839611134013664979081937740355095030594753200467570219100609703697922384653710 E-13*x^33 - 6.071346533279142803685379120314621108685350761503661550708731567075112002836324528430226796491773892 E-13*x^32 - 8.695244509074531549465113607068712135112578801523445579063772612518454297535398514799412961357257463 E-13*x^31 + 8.185612812396585201172121060843930835834538393255973634472241552864846030699653097387845707531221035 E-12*x^30 - 5.910333432880776741384027002173514201733530649450909127780854862702406905506413312105629803494617324 E-12*x^29 - 7.925808095981798487965517622873139274160484320450413225612781040424948702820306295356474611755142433 E-11*x^28 + 1.935228900467027173852974475616402192078815624580526480620522266388232900074487492355989152622306118 E-10*x^27 + 0.0000000005053399473717128218075007224551560458901277067006137056081400113716595176301660224856974197958469941*x^26 - 0.000000002537585312592508206400765196675019310630933006544243735055944032850685482807084041330706024932983699*x^25- 0.0000000006464587606637331908796468255938951252698219903211030550591453996853087864476153882991525445817035948*x^24+ 0.00000002194417045202108594249584124985466217381950113001741921209735720253858127505738988862967440389610597*x^23- 0.00000003319939379386106168754882120196185185033047934773129577518250737150766731072980444561045996337855899*x^22- 0.0000001237400320230436403882626542654051086839083737848428509937582547396937759092886179073258041568639485*x^21+ 0.0000005115874315987804997581224034332285922940023855493510316743803819123830694077730923888691443031040355*x^20+ 0.0000002446705701293465596655495510705145410379697896084131756306238483009102810196838343949284840275055675*x^19- 0.000004383754300956681784229598660405339413404990086616890700980239774875807198574152100112372893254648196*x^18+ 0.000003686169518687613417521394231627888371305771129035394715825285297787117013937709588112036081681286818*x^17+ 0.00002276779788954193761353215550685250895943632515603855196456626103086241501459940803601800109102475923*x^16- 0.00005296326261914883380845021527460267841184612746874902058759901261166728088605736006800844450399949737*x^15- 0.00004054379774855447457383232859844533107843759864852256417995370006381112585938698264721512121329396575*x^14+ 0.0004015406809776814873124776692448527262435787442419474185968223067556807091089910162956924698728472088*x^13- 0.0004098322406754108795638427319531134285211994926097764000504321409591052591395680629246463920931182688*x^12- 0.001931090293074242988160524033556198026824748166226442805049404896699319447582239868054191070324618878*x^11+ 0.004054493563603041826231373596340541082714869416758900613172869993631362790479759344189711294922384159*x^10+ 0.004262209325348677248861971312717181931557558319345239166831500057951542400872129318292536292743399288*x^9- 0.01794149556808066930786811873981429104931674121454820253578196862924483553715675828025607006606085047*x^8+ 0.01369539040954553628377746226363376837308112109785099765554440649099137668724046797510486683811619374*x^7+ 0.04493216865755032865305828936059872801902504891760982951150796823774769501916273475312390857432300267*x^6- 0.1318797229272497440696367036591840332768203181775291574244887191213013248988178959951409227049365073*x^5- 0.05040228946390985334748019665202135282982602488166862591052629203185169409381145144855099951898962049*x^4+ 0.3115372584465096416981625851175171210704617389166936458242782817815084959866747784886881671938344472*x^3- 0.1762478124425813950480075785363110653531845471652321847791032697139753323039547192734667661697026804*x^2+ 1;
   return(r);
}

MN(s,NN)=prod(j=1,NN,(j-1)!*gamma(j+I*s)/gamma(j+I*s/2)^2);

/* This includes an estimate (ARB)
   of the arithmetic factor
   a(Is/2)*MN(s.NN) looks even to me
   so do from 0..a and double.
*/

dista(y,NN,a)=2*one_2_pi*intnum(s=0,a,real(MN(s,NN)*arith(I*s/2)*exp(-I*y*s)));

/* a3 is the extra arithmetic factor due to 3 dividing q */
a3(lam,M)=if(lam==0,1,gamma(lam)^2/sum(m=0,M,gamma(m+lam)^2/(m!)^2/3^m));

dista3(y,NN,a)=one_2_pi*intnum(s=-a,a,real(MN(s,NN)*arith(I*s/2)*a3(I*s/2,20)*exp(-I*y*s)));

st=-18.971;
en=9.971;
steps=500.0;
NN=20;

main()=
{
   local (del,y);
   del=(en-st)/(steps-1);
   y=st;

/* just the basic dist
   for(i=1,steps,print(y," ",dist(y,NN,7));y=y+del);
*/
/* basic plus arithmetic

   for(i=1,steps,print(y," ",dista3(y,NN,7));y=y+del);
*/
/* Full jobby */
   for(i=1,steps,print(y," ",dista3(y,NN,7));y=y+del);

}

main();

quit;
